Title: 在Excel中数据加工的好用方法
Category: 数据分析
Date: 2025-06-14 21:00
Tags: Excel, 数据清洗
Slug: excel-clean-data3
### **1. 项目概览**
- **项目背景**：某公司收集了员工数据（部分字段如下），需进行数据加工以满足分析需求：
1.	员工号（如 “20230001”）
2.	入职日期（如 “2023-10-01”）
3.	身份证号（18 位，如 “11010119900101XXXX”）
4.	月薪（如 8000 元）
5.	部门（如 “销售部”“技术部”）

- **数据规模**：标注数据量:1000条，5维度、数据来源:模拟数据.
- **项目周期**：1.5h

#### **2. 技术路径**
- **数据处理**：  
##### 从 “身份证号” 中提取 “出生年份” 和 “性别”：
1.	出生年份：使用MID(身份证号,7,4)函数，截取第 7 到第 10 位字符。
2.	性别：提取身份证号第 17 位，用IF(MOD(MID(身份证号,17,1),2)=1,"男","女")判断奇偶性。
##### 计算各员工的 “工龄”（入职年份到当前年份的工作年限）：
1.	公式:DATEDIF(入职日期, TODAY(), "Y").

DATEDIF函数是 Excel 中用于计算两个日期之间差值的函数，语法是DATEDIF(start_date,end_date,unit)。start_date是起始日期，end_date是结束日期，unit是返回差值的类型，比如 "Y" 是返回整年数，"M" 是返回整月数，"D" 是返回天数。
##### 需按 “月薪” 将员工分为 “高薪”（≥15000 元）、“中薪”（8000-15000 元）、“低薪”（<8000 元）：
1.	VLOOKUP 函数分组：创建阈值表（低薪 < 8000，中薪 8000-15000，高薪≥15000）；
2.  在员工表中新增 “薪酬等级” 列，输入公式=VLOOKUP(月薪, 阈值表, 2, 1)（模糊匹配）(这里例子是=VLOOKUP(D2,J$2:K$4,2,1))
#### **3. 附件**
- [下载模拟数据](attach/员工模拟数据.xlsx)


