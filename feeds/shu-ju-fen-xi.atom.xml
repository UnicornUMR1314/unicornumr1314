<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Uni星人的博客 - 数据分析</title><link href="https://unicornumr1314.github.io/" rel="alternate"></link><link href="https://unicornumr1314.github.io/feeds/shu-ju-fen-xi.atom.xml" rel="self"></link><id>https://unicornumr1314.github.io/</id><updated>2025-06-14T21:00:00+08:00</updated><entry><title>在Excel中清洗数据的好用方法2</title><link href="https://unicornumr1314.github.io/excel-clean-data2.html" rel="alternate"></link><published>2025-06-14T21:00:00+08:00</published><updated>2025-06-14T21:00:00+08:00</updated><author><name>Uni星人</name></author><id>tag:unicornumr1314.github.io,2025-06-14:/excel-clean-data2.html</id><summary type="html">&lt;h3&gt;&lt;strong&gt;1. 项目概览&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;项目背景&lt;/strong&gt;：某电商平台收集了用户订单数据，存在以下问题：&lt;/li&gt;
&lt;li&gt;重复数据：同一用户 ID 出现多次相同订单（订单号重 …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h3&gt;&lt;strong&gt;1. 项目概览&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;项目背景&lt;/strong&gt;：某电商平台收集了用户订单数据，存在以下问题：&lt;/li&gt;
&lt;li&gt;重复数据：同一用户 ID 出现多次相同订单（订单号重复）。&lt;/li&gt;
&lt;li&gt;缺失数据：部分订单的 “支付时间” 字段为空。&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;逻辑错误：“订单金额” 字段出现负数（如 - 50 元），“商品数量” 字段出现 0 件。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;数据规模&lt;/strong&gt;：标注数据量:115条，7维度、数据来源:模拟数据.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;项目周期&lt;/strong&gt;：1h&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;&lt;strong&gt;2. 技术路径&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;数据处理&lt;/strong&gt;：  &lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;重复数据处理：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;选中 “订单号” 列，使用 “数据→删除重复项”，勾选 “订单号”，删除完全重复的订单记录。&lt;/li&gt;
&lt;/ol&gt;
&lt;h5&gt;缺失数据处理：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;通过 “数据→筛选” 选中所有 “支付时间” 为空的单元格。&lt;/li&gt;
&lt;li&gt;计数筛选出的单元格数量.方法⑴:框选一列,然后看Excel底部状态栏的统计数据;方法⑵:找一个空单元格,使用“分类汇总” 函数计数&lt;strong&gt;=SUBTOTAL(3,A:A)-1&lt;/strong&gt;.(3 对应的名称是 COUNTA（非空单元格个数）)&lt;/li&gt;
&lt;li&gt;鉴于支付时间缺失比例达13%,而又比较重要,手动填充合理时间(订单创建时间+12h(支付和创建订单的平均间隔时间))&lt;/li&gt;
&lt;/ol&gt;
&lt;h5&gt;逻辑错误处理：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;列出可能的逻辑错误,如 “订单金额 &amp;lt; 0” 或 “商品数量 = 0” 的单元格.&lt;/li&gt;
&lt;li&gt;使用"筛选"功能,筛选出"商品数量&amp;lt;=0"的单元格,然后删除掉这些行.&lt;/li&gt;
&lt;li&gt;使用"筛选"功能,筛选出"订单金额&amp;lt;0"的单元格.&lt;/li&gt;
&lt;li&gt;核对错误数据：若为录入错误，修正为正确值（如 - 50 元改为 50 元）；若为无效数据，删除对应记录。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;&lt;strong&gt;3. 附件&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://unicornumr1314.github.io/电商订单模拟数据.xlsx"&gt;下载模拟数据&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="数据分析"></category><category term="Excel"></category><category term="数据清洗"></category></entry><entry><title>在Excel中数据加工的好用方法</title><link href="https://unicornumr1314.github.io/excel-clean-data3.html" rel="alternate"></link><published>2025-06-14T21:00:00+08:00</published><updated>2025-06-14T21:00:00+08:00</updated><author><name>Uni星人</name></author><id>tag:unicornumr1314.github.io,2025-06-14:/excel-clean-data3.html</id><summary type="html">&lt;h3&gt;&lt;strong&gt;1. 项目概览&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;项目背景&lt;/strong&gt;：某公司收集了员工数据（部分字段如下），需进行数据加工以满足分析需求：&lt;/li&gt;
&lt;li&gt;员工号（如 “20230001”）&lt;/li&gt;
&lt;li&gt;入职日期（如 “2023-10-01 …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h3&gt;&lt;strong&gt;1. 项目概览&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;项目背景&lt;/strong&gt;：某公司收集了员工数据（部分字段如下），需进行数据加工以满足分析需求：&lt;/li&gt;
&lt;li&gt;员工号（如 “20230001”）&lt;/li&gt;
&lt;li&gt;入职日期（如 “2023-10-01”）&lt;/li&gt;
&lt;li&gt;身份证号（18 位，如 “11010119900101XXXX”）&lt;/li&gt;
&lt;li&gt;月薪（如 8000 元）&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;部门（如 “销售部”“技术部”）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;数据规模&lt;/strong&gt;：标注数据量:1000条，5维度、数据来源:模拟数据.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;项目周期&lt;/strong&gt;：1.5h&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;&lt;strong&gt;2. 技术路径&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;数据处理&lt;/strong&gt;：  &lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;从 “身份证号” 中提取 “出生年份” 和 “性别”：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;出生年份：使用MID(身份证号,7,4)函数，截取第 7 到第 10 位字符。&lt;/li&gt;
&lt;li&gt;性别：提取身份证号第 17 位，用IF(MOD(MID(身份证号,17,1),2)=1,"男","女")判断奇偶性。&lt;/li&gt;
&lt;/ol&gt;
&lt;h5&gt;计算各员工的 “工龄”（入职年份到当前年份的工作年限）：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;公式:DATEDIF(入职日期, TODAY(), "Y").&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;DATEDIF函数是 Excel 中用于计算两个日期之间差值的函数，语法是DATEDIF(start_date,end_date,unit)。start_date是起始日期，end_date是结束日期，unit是返回差值的类型，比如 "Y" 是返回整年数，"M" 是返回整月数，"D" 是返回天数。&lt;/p&gt;
&lt;h5&gt;需按 “月薪” 将员工分为 “高薪”（≥15000 元）、“中薪”（8000-15000 元）、“低薪”（&amp;lt;8000 元）：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;VLOOKUP 函数分组：创建阈值表（低薪 &amp;lt; 8000，中薪 8000-15000，高薪≥15000）；&lt;/li&gt;
&lt;li&gt;在员工表中新增 “薪酬等级” 列，输入公式=VLOOKUP(月薪, 阈值表, 2, 1)（模糊匹配）(这里例子是=VLOOKUP(D2,J$2:K$4,2,1))&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;&lt;strong&gt;3. 附件&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="attach/员工模拟数据.xlsx"&gt;下载模拟数据&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="数据分析"></category><category term="Excel"></category><category term="数据清洗"></category></entry><entry><title>在Excel中清洗数据的好用方法</title><link href="https://unicornumr1314.github.io/excel-clean-data.html" rel="alternate"></link><published>2025-06-05T21:00:00+08:00</published><updated>2025-06-05T21:00:00+08:00</updated><author><name>Uni星人</name></author><id>tag:unicornumr1314.github.io,2025-06-05:/excel-clean-data.html</id><summary type="html">&lt;h3&gt;&lt;strong&gt;1. 项目概览&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;项目背景&lt;/strong&gt;：某公司开展员工满意度调查，回收问卷后得到原始数据，需要对原始数据进行清洗.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数据规模&lt;/strong&gt;：标注数 …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h3&gt;&lt;strong&gt;1. 项目概览&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;项目背景&lt;/strong&gt;：某公司开展员工满意度调查，回收问卷后得到原始数据，需要对原始数据进行清洗.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数据规模&lt;/strong&gt;：标注数据量1000条数据+6个维度、数据来源企业脱敏数据。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;项目周期&lt;/strong&gt;：独立完成，耗时4h。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;&lt;strong&gt;2. 技术路径&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;数据处理&lt;/strong&gt;：&lt;br&gt;
  经过分析,该原始数据存在以下问题：&lt;/li&gt;
&lt;li&gt;部分问卷的 “年龄” 字段为空值；&lt;/li&gt;
&lt;li&gt;“入职日期” 字段格式不一致（如 “2023-01”“2023 年 1 月”“2023/1”）；&lt;/li&gt;
&lt;li&gt;存在重复提交的问卷（同一员工提交了 2 次）；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;处理方法&lt;/strong&gt;：&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;插入数据透视表,以"部门"为行,以"年龄为值"统计每个部门平均年龄;
  用Excel的筛选功能,筛选出"年龄"为空的行,再筛选出“部门”为“销售部”的行,统一填入销售部的平均年龄。如此可以快速填充缺失值。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;通过 “拆分格式→文本转换→汇总统一→转日期类型” 的流程，将混乱的多格式日期，逐步规范为统一的日期值：
拆分格式：为每种日期格式建列，明确处理对象；
文本转换：用 IF+MID 把不同格式转成统一文本（如 YYYY-MM-DD 文本）；
汇总统一：用 IF 合并结果，确保每行一个统一文本；
转日期：用 DATE+MID 将文本转为真正的日期类型（可参与日期计算）。
（注：步骤 2 中 IF 返回的 0 需注意过滤，避免影响后续转换；函数操作在 Excel、Google Sheets 等工具中通用，语法略有差异时需调整。）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;用Excel的“删除重复项”功能，将重复提交的问卷删除。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;以下是统一多格式日期数据的逐点解析：&lt;/h4&gt;
&lt;p&gt;1️⃣. 对每一种日期格式添加一个列
目的：先梳理数据中存在的日期格式（如 YYYY-MM-DD、MM/DD/YYYY、DD.MM.YYYY 等），为每种格式单独建列。
作用：方便后续针对不同格式的字符串，分别提取年、月、日信息。&lt;/p&gt;
&lt;p&gt;2️⃣. 使用 IF 结合 MID，转化为目标格式的常规文本（false 忽略会返回 0）
逻辑：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;MID(text, start_num, num_chars)：从字符串中按位置截取字符（比如从 MM/DD/YYYY 中截取月份 MID(A1, 1, 2)）。
IF(condition, value_if_true, value_if_false)：判断日期格式，针对性截取年、月、日，拼接成 统一文本格式（如 YYYY-MM-DD 的文本，而非日期类型）。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;注意：若 IF 的条件不满足（value_if_false），默认返回 0，需后续处理无效值。&lt;/p&gt;
&lt;p&gt;3️⃣. 添加一个汇总列，用 IF 进行汇总
目的：将步骤 2 中不同格式列的结果，统一合并到一列。
逻辑：用 IF 判断哪一列有有效文本（非空、非 0），将其值提取到汇总列。例如：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;IF&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;格式列&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;格式列&lt;span class="mi"&gt;1&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;IF&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;格式列&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;格式列&lt;span class="mi"&gt;2&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;...&lt;span class="ss"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;确保每行只有 一个统一的文本日期（如 2023-01-01 形式的文本）。&lt;/p&gt;
&lt;p&gt;4️⃣. 再添加一个日期列，用 DATE() 结合 MID() 将常规文本转化为日期
逻辑：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;DATE(year, month, day)：将数字型的年、月、日转化为 日期类型（如 DATE(2023, 1, 1) 返回 2023/1/1 日期）。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;先用 MID 从汇总文本中提取年、月、日的数字（如从 2023-01-01 中提取 MID(汇总列, 1, 4) 作为年），再传给 DATE 函数，最终生成标准日期。&lt;/p&gt;</content><category term="数据分析"></category><category term="Excel"></category><category term="数据清洗"></category></entry></feed>